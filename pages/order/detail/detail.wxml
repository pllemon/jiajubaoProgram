<view wx:if="{{finish}}">
    <view class="blue-header flex-center-between">
      <view>
        <view class="title">{{orderStatus.label}}</view>
        <view>{{orderStatus.desc}}</view>
      </view>
      <icon class="iconfont {{orderStatus.icon}}"></icon>
    </view>

    <view class="concat-mes">
      <view wx:if="{{orderStatus.showUser}}" class="flex-center-between concat-single" style="border-bottom: 1px solid #f2f2f2;">
        <gdImage src="" class="personal-img" width="80rpx" height="80rpx"></gdImage>
        <view class="flex1">
          <view class="name">{{orderMes.info.username}}</view>
          <view>{{orderMes.info.phone}}</view>
        </view>
        <view class="flex-center phone" wx:if="{{orderStatus.showUserPhone}}" data-phone="{{orderMes.info.phone}}" bindtap="makePhoneCall">
          <icon class="iconfont iconicon_phone" style="margin-right:10rpx"></icon>
          <text>联系</text>
        </view>
      </view>
      <view wx:if="{{orderStatus.showMaster}}" class="flex-center-between concat-single">
        <gdImage src="" class="personal-img" width="80rpx" height="80rpx"></gdImage>
        <view class="flex1">
          <view class="name">{{orderMes.craftsmaninfo.name}}（{{orderMes.craftsmaninfo.sn}}）</view>
          <view>{{orderMes.craftsmaninfo.phone}}</view>
        </view>
        <view class="flex-center phone" wx:if="{{orderStatus.showMasterPhone}}" data-phone="{{orderMes.craftsmaninfo.phone}}" bindtap="makePhoneCall">
          <icon class="iconfont iconicon_phone" style="margin-right:10rpx"></icon>
          <text>联系</text>
        </view>
      </view>
    </view>

  
    <!-- 订单信息 -->
    <view class="order-single">
      <view class="category">{{orderMes.info.service_demand}}</view>
      <view class="mes">
        <icon class="iconfont iconicon_GPS"></icon>
        <text class="content">{{orderMes.info.address}}</text>
      </view>
      <view class="mes">
        <icon class="iconfont iconicon_calendar"></icon>
        <text class="content">{{orderMes.info.appo_time ? orderMes.info.appo_time : '上门时间待沟通'}}</text>
      </view>
      <view class="mes" wx:if="{{orderMes.info.remark}}">
        <icon class="iconfont iconicon_community_line"></icon>
        <text class="content">{{orderMes.info.remark}}</text>
      </view>
      <view class="other">
        <view class="label green">天河网点1</view>
        <view class="label red">加急</view>
      </view>
      <block wx:if="{{orderMes.userimglist.length > 0}}">
        <swiper indicator-dots="{{indicatorDots}}" autoplay="{{autoplay}}" interval="{{interval}}" duration="{{duration}}" style="margin-top: 30rpx">
          <block wx:for="{{orderMes.userimglist}}" wx:key="id">
            <swiper-item>
              <gdImage  class="slide-image" src="{{ item }}" preview label="订单图"></gdImage>
            </swiper-item>
          </block>
        </swiper>
      </block>
    </view>

    <view class="common-section">
      <view class="title">订单信息</view>
      <view class="message">
        <view>
          <text>订单编号</text>
          <text>{{orderMes.info.order_sn}}</text>
        </view>
        <view>
          <text>下单时间</text>
          <text>{{orderMes.info.create_time}}</text>
        </view>
        <block wx:if="{{orderMes.info.status > 1}}">
          <view>
            <text>订单总额</text>
            <text class="money">￥{{orderMes.pay.total_price}}</text>
          </view>
        </block>
      </view>
    </view>

    <view class="common-section" wx:if="{{orderStatus.showSignUp}}">
      <view class="title">报名情况({{orderMes.craftsmanlist.length}})</view>
      <view class="sign-list" wx:if="{{orderMes.craftsmanlist.length>0}}">
        <block wx:for="{{orderMes.craftsmanlist}}" wx:key="index">
          <view class="sign-single flex-center-between">
            <view class="flex-center-start">
              <gdImage src="{{ item.imgurl }}" class="personal-img" width="80rpx" height="80rpx"></gdImage>
              <text>{{item.name}}</text>
            </view>
            <!-- <button wx:if="{{personType == 0 && orderMes.info.status == 4}}" size="mini" class="button-plain" data-id="{{item.craftsman_id}}" bindtap="chooseMaster">选择</button> -->
          </view>
        </block>
      </view>
      <view class="flex-center" wx:if="{{orderMes.craftsmanlist.length==0}}" style="height: 300rpx">
        还没有师傅报名哦~
      </view>
    </view>

    <view class="common-section" wx:if="{{orderMes.ordersshow}}">
      <view class="title">施工情况</view>
      <view class="show-single">
        <view class="img-list">
          <gdImage wx:if="{{orderMes.ordersshow.imgurl1}}" src="{{ orderMes.ordersshow.imgurl1 }}" preview label2="开工图"></gdImage>
          <gdImage wx:if="{{orderMes.ordersshow.imgurl3}}" src="{{ orderMes.ordersshow.imgurl3 }}" preview label2="竣工图"></gdImage>
        </view>
      </view>
    </view>

    <view style="height: 130rpx" wx:if="{{orderStatus.showAction}}"></view>

    <!-- 操作按钮 -->
    <view class="main-action flex-center-between" wx:if="{{personType == 0 && orderStatus.showAction}}">
      <!-- <view class="flex-center service">
        <icon class="iconfont iconkefu"></icon>
        <text>客服</text>
      </view> -->
      <button wx:if="{{orderMes.info.status == 1 || orderMes.info.status == 2}}" bindtap="showPopup" class="main-btn flex1">取消订单</button>
      <button wx:if="{{orderMes.info.status == 2}}" bindtap="payearnestprice" class="main-btn flex1">支付</button>
      <button wx:if="{{orderMes.info.status == 6}}" bindtap="paytailprice" class="main-btn flex1">确认完成</button>
      <button wx:if="{{orderMes.info.status == 8 && orderMes.info.is_comment == 1}}" bindtap="makeOrder" class="main-btn flex1">再次下单</button>
      <button wx:if="{{orderMes.info.status == 8 && orderMes.info.is_comment == 0}}" bindtap="goComment" class="main-btn flex1">评价订单</button>
      <button wx:if="{{orderMes.info.status == 10}}" bindtap="makeOrder" class="main-btn flex1">再次下单</button>
    </view>

    <view class="main-action flex-center-between" wx:if="{{personType == 1 && orderStatus.showAction}}">
      <!-- <view class="flex-center service">
        <icon class="iconfont iconkefu"></icon>
        <text>客服</text>
      </view> -->
      <button wx:if="{{orderMes.info.status == 5 && !orderMes.ordersshow}}" bindtap="cancelOrder2" class="main-btn plain flex1">取消订单</button>
      <button wx:if="{{orderMes.info.status == 5 && !orderMes.ordersshow}}" bindtap="beginWork" class="main-btn flex1">开始施工</button>
      <button wx:if="{{orderMes.info.status == 5 && orderMes.ordersshow}}" bindtap="endWork" class="main-btn flex1">施工完成</button>
      <button wx:if="{{orderMes.info.status > 5 && orderMes.info.status < 8}}" class="main-btn flex1 disable">待客户确认完工</button>
      <button wx:if="{{orderMes.info.status == 8 && orderMes.ordersshow}}" bindtap="signUpOrder" class="main-btn flex1">再次抢单</button>
      <button wx:if="{{orderMes.info.status == 4 && !orderMes.craftsmanorderinfo}}" bindtap="masterSignUp" class="main-btn flex1">立即报名</button>
    </view>
</view>

<van-popup
  show="{{ isPopup }}"
  position="top"
  bind:close="closePopup"
>
    <form bindsubmit="formSubmit" class="form" style="padding: 30rpx;">
        <textarea height="300rpx" bindinput="inputCancelRemark" focus="{{isPopup}}" placeholder="请输入"/>
        <button form-type="submit" class="main-btn">确认取消</button>
    </form>
</van-popup>